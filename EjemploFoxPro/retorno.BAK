&& Objetivo  : Analisar el retorno das funções da DLL
&& Parâmetro : iRetorno 

function Analisa_iRetorno
parameters iRetorno

if iRetorno <> 1
	do case
        case iRetorno = 0
             MessageBox( "Erro de Comunicação !", "Erro" )
        case iRetorno = -2
             MessageBox( "Parâmetro Inválido !", "Erro" )     
        case iRetorno = -3
             MessageBox( "Alíquota não programada !", "Atenção" )     
        case iRetorno = -18
             MessageBox( "Não foi possível abrir arquivo INTPOS.001 !" )     
        case iRetorno = -19
             MessageBox( "Parâmetro diferentes !", "Atenção" )     
        case iRetorno = -20
             MessageBox( "Transação cancelada pelo Operador !", "Atenção" )     
        case iRetorno = -21
             MessageBox( "A Transação não foi aprovada !", "Atenção" )     
        case iRetorno = -22
             MessageBox( "Não foi possível terminar a Impressão !", "Atenção" )     
        case iRetorno = -23
             MessageBox( "Não foi possível terminar a Operação !", "Atenção" )              
    endcase
else
  	iACK = 1
  	iST1 = 2
  	iST2 = 1
  	cMSGErro = ""
  	iRetorno = Bematech_FI_RetornoImpressora( iACK, iST1, iST2 )   
    if iACK = 21 
    	= MESSAGEBOX( [A Impressora retornou NAK !], 16+0+0, [Atenção] )
    else
		if ( iST1 <> 0 ) .OR. ( iST2 <> 0 )
       		&& Analisa ST1

            if ( iST1 >= 128 ) 
                iST1 = iST1 - 128
                cMSGErro = cMSGErro + "Fim de Papel" + chr(13)
            endif    
            if ( iST1 >= 64 )
               	iST1 = iST1 - 64
               	cMSGErro = cMSGErro + "Pouco Papel" + chr(13)
            endif
            if ( iST1 >= 32 ) 
               	iST1 = iST1 - 32
               	cMSGErro = cMSGErro + "Erro no Relógio" + chr(13)
            endif
 		    if ( iST1 >= 16 ) 
				iST1 = iST1 - 16
				cMSGErro = cMSGErro + 'Impressora em Erro' + chr(13)
			endif
			if ( iST1 >= 8 ) 
				iST1 =  iST1 - 8 
				cMSGErro =  cMSGErro + "Primeiro Dado do Comando não foi ESC" + chr(13) 
			endif
		    if iST1 >= 4 
				iST1 =  iST1 - 4 
				cMSGErro =  cMSGErro + "Comando Inexistente" + chr(13) 
			endif
 		    if iST1 >= 2  
                iST1 =  iST1 - 2 
                cMSGErro =  cMSGErro + "Cupom Fiscal Aberto" + chr(13) 
            endif    
            if iST1 >= 1  
                iST1 =  iST1 - 1 
                cMSGErro =  cMSGErro + "Número de Parâmetros Inválidos" + chr(13) 
            endif

            && Analisa ST2

            if iST2 >= 128  
                iST2 =  iST2 - 128 
                cMSGErro =  cMSGErro + "Tipo de Parâmetro de Comando Inválido" + chr(13) 
            endif    
            if iST2 >= 64  
                iST2 =  iST2 - 64 
                cMSGErro =  cMSGErro + "Memória Fiscal Lotada" + chr(13) 
            endif    
            if iST2 >= 32  
                iST2 =  iST2 - 32 
                cMSGErro =  cMSGErro + "Erro na CMOS" + chr(13) 
            endif 
            if iST2 >= 16  
                iST2 =  iST2 - 16 
                cMSGErro =  cMSGErro + "Alíquota não Programada" + chr(13) 
            endif
            if iST2 >= 8  
                iST2 =  iST2 - 8 
                cMSGErro =  cMSGErro + "Capacidade de Alíquota Programáveis Lotada" + chr(13) 
            endif
            if iST2 >= 4  
                iST2 =  iST2 - 4 
                cMSGErro =  cMSGErro + "Cancelamento não permitido" + chr(13) 
            endif
            if iST2 >= 2  
                iST2 =  iST2 - 2 
                cMSGErro =  cMSGErro + "CGC/IE do Proprietário não Programados" + chr(13) 
            endif
            if iST2 >= 1  
                iST2 =  iST2 - 1 
                cMSGErro =  cMSGErro + "Comando não executado" + chr(13) 
            endif
            if ( cMSGErro <> "" )  
                 = MESSAGEBOX( [cMSGErro ], 16+0+0, [Atenção] )
            endif     
       endif     
  endif 
endif  
return ( iRetorno )